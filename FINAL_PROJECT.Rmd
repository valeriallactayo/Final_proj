---
title: "Proyecto de fin de semestre"
subtitle: "Analisis de incendios forestales"

date: "Septiembre 2021"
output: 
html_document:
  toc: true
  toc_depth: 5
  toc_float: 
  collapsed: false
  smooth_scroll: true
header-includes:
  - \renewcommand{\and}{\\}
---

Alumno | Código
-- | --
Valeria Llactayo Peña | 17160046
Joaquin Romualdo Peña | 17150052
Javier Sullcaray Barrientos | 17160200
Jose Victorio Gonzales | 17160051
Daniel Yauri Leiva | 17160208

> En el presente trabajo se muestra el proceso de manipulación de datos de incendios forestales.

```{r }
#Comenzaremos subiendo los datos que usaremos
load("workspace.Rdata")
```
## LIBRERÍAS UTILIZADAS
pacman :: p_load(tidyverse, 
                 lattice, 
                 psych, 
                 PerformanceAnalytics, 
                 GGally, 
                 cptcity,
                 library(factoextra))

## ANÁLISIS EXPLORATORIO DE DATOS

## ANÁLISIS DE COMPONENTES PRINCIPALES

```{r}
fires <- read_csv("forestfires.csv") %>% 
  print()
```

```{r}
fires %>% select(-c("X", "Y", "day"))
```

```{r}
fires_pca <- select(fires, 5:13) %>% 
  print()
```

#describiendo los datos
```{r}
describe(fires_pca)
```

#esttandarizando
```{r}
fires_pca_esc <- scale(fires_pca) %>% as_tibble() %>% 
  print()
```

#matriz de correlación

```{r}
correlation <- cor(fires_pca_esc)
```

#matriz de varianza-covarianza

```{r}
matrix_cov <- cov(fires_pca_esc)
```

#suma de la diagonal o "varianza total"

```{r}
diag(matrix_cov) %>% sum() 
```

```{r}
chart.Correlation(fires_pca_esc, histogram = T, pch = 20)
```

```{r}
levelplot(
  correlation,
  col.regions = 
    cpt(
      pal = "cb_div_RdBu_11", n = 100
    )
)
```

#calculando eigenvectors y eigenvalues

```{r}
eigen <- eigen(matrix_cov) %>% print()
```

#calculando el pca

```{r}
library(ade4)
pca <- dudi.pca(fires_pca_esc, 
                scale = F, 
                scannf = F,
                nf = ncol(fires_pca_esc)
)
```

```{r}
summary(pca)
```

```{r}
pca$eig
```

```{r}
sum(pca$eig)
```

#autovectores
```{r}
pca$c1
```


```{r}
fviz_eig(pca,addlabels = T)
```

